---
title: "Statistical Data Analysis of Student Goals"
author: Mateusz Zaremba
date: November 4, 2019
output: 
  pdf_document:
    toc: false
    toc_depth: 2
    number_sections: true
    fig_caption: true
    df_print: kable
    highlight: tango
    citation_package: natbib
    keep_tex: false
fontzise: 11pt
geometry: margin=1.5in
documentclass: article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, tidy = FALSE, cache = TRUE, fig.cap = "...")

# load libraries
library(tidyverse)
library(modelr)
library(rsample)
library(broom)
library(magrittr)

# set seed for randomization to ensure that results are always reproduced precisely
set.seed(1234)
```

```{r, load}
# read csv file (worse variable recognition)
f <- "data/StudentGoalsData.csv"
StudentGoalsOriginal <- read_csv(f, col_types = cols(), skip_empty_rows = TRUE)
```

```{r, remove seq}
# drop 'seq' column since it doesn't serve any purpose
StudentGoalsData <- StudentGoalsOriginal  %>%  ungroup  %>%  select(-seq)
```

```{r}
# count all the students before cleaning and dropping the data
n <- tally(StudentGoalsData)
```

```{r}
# # clean data - drop results contaiting empty cells
CleanedStudentGoalsData <- drop_na(StudentGoalsData)
```

```{r}
# save CleanedStudentGoalsData table in a simple variable called 'dat'
dat <- CleanedStudentGoalsData
```

```{r}
# save CleanedStudentGoalsData table as tibble table in a variable called 'dat_tibble'
dat_tibble <- tibble::as_tibble(CleanedStudentGoalsData)
```

```{r}
# Renaming columns according to random order: 6, 12, 11, 1, 7, 2, 10, 8, 5, 3, 9, 4
renamed_data <- dat_tibble %>%
  rename(
    Q6 = q1,
    Q12 = q2,
    Q11 = q3,
    Q1 = q4, 
    Q7 = q5, 
    Q2 = q6, 
    Q10 = q7, 
    Q8 = q8, 
    Q5 = q9, 
    Q3 = q10, 
    Q9 = q11, 
    Q4 = q12
  )
# going back to lower case 'q' to keep naming consistent with the original data set
renamed_data2 <- renamed_data %>%
  rename(
    q1 = Q1, q2 = Q2, q3 = Q3, q4 = Q4, q5 = Q5, q6 = Q6, 
    q7 = Q7, q8 = Q8, q9 = Q9, q10 = Q10, q11= Q11, q12 = Q12
  )
# save renamed table in 'dat' variable
dat <- renamed_data2
# summary(dat)
# plot(dat) # r function for plotting
# dat[1:4, 1:4]
```

```{r}
# renaming values to their proper labeling from assets/'Student Goals - Coding Information.pdf'
# replace numericals in the 'sex' column with proper sex names
dat$sex[dat$sex==1] <- 'Male'
dat$sex[dat$sex==2] <- 'Female'
# replace numericals in the 'subject' column with proper subject names
dat$subject[dat$subject==1] <- 'Management'
dat$subject[dat$subject==2] <- 'Law'
dat$subject[dat$subject==3] <- 'Tourism'
dat$subject[dat$subject==4] <- 'General Economics'
dat$subject[dat$subject==5] <- 'Accounting'
dat$subject[dat$subject==6] <- 'Statistics'
```

```{r}
## Calculate mean for 7 categories:
# across 7 categories:
# - q1, q2, q3 - Performance approach questions
# - q4, q5, q6 - Performance avoidance questions
# - q7, q8, q9 - Mastery-Approach
# - q10, q11, q12 - Mastery-Avoidance
# - Interest
# - Enjoyment
# - Understanding/Grades

mean_dat <- dat
# get mean from q1, q2, q3 columns (Performance approach questions) for all the students
# save the results in 'm1' colum and add it to 'mean_dat' table
mean_dat <- mean_dat %>% 
  mutate(m1 = pmap_dbl(select(., c("q1", "q2", "q3")), function(...) mean(c(...))))

# get mean from q4, q5, q6 columns (Performance avoidance questions) for all the students,
# save the results in 'm2' colum and add it to 'mean_dat' table
mean_dat <- mean_dat %>% 
  mutate(m2 = pmap_dbl(select(., c("q4", "q5", "q6")), function(...) mean(c(...))))

# get mean from q7, q8, q9 columns (Mastery approach questions) for all the students
# save the results in 'm3' colum and add it to 'mean_dat' table
mean_dat <- mean_dat %>% 
  mutate(m3 = pmap_dbl(select(., c("q7", "q8", "q9")), function(...) mean(c(...))))

# get mean from q10, q11, q12 columns (Mastery avoidance questions) for all the students 
# save the results in 'm4' colum and add it to 'mean_dat' table
mean_dat <- mean_dat %>% 
  mutate(m4 = pmap_dbl(select(., c("q10", "q11", "q12")), function(...) mean(c(...))))

# save final cleaned table
write_csv(mean_dat, "data/MeanCleanedStudentGoals.csv")
# save final cleaned table as tibble table
dat_tibble <- as_tibble(mean_dat)
```

```{r}
## CLASSIFICATION ###################################################
# dat_tibble %>%
#   head() %>%
#   knitr::kable()

# Find a student who is not enjoying the course, finds it not interesting but still primarly aims to perform better than others and is lead by the fear of performing poorly
dat_tibble_enjoy <- filter(dat_tibble, enjoy <= 2)
dat_tibble_interest <- filter(dat_tibble_enjoy, interest <= 2)
dat_tibble_mastgrad <- filter(dat_tibble_interest, m1 >= 6)
mm1 <- filter(dat_tibble_mastgrad, m1 >= 6)
mm2 <- filter(mm1, m2 >= 6)

n_mm2 <- tally(mm2)
beta <- n_mm2 / n # 0.3392

ci <- beta * ((1 - beta)/(n)) # 0.0003586294
ci_sqrt <- sqrt(ci) # 0.0189
ci_margin_error <- ci_sqrt * 1.96 # 0.0371 or 3.71% 

# Our 95% confidence interval for the percentage of times we will get a student with a mean of
# 5 or above for the set of m1 questions is 0.3392 (or 34%), plus or minus 0.03711 (or 3.7%).
# The lower end of the interval is 0.3392 - 0.03711 which is:
lower_end_of_interval <- beta - ci_margin_error # 0.3020825 or 30%
# The upper end of the interval is 0.3392
upper_end_of_interval <- beta + ci_margin_error # 0.3763175 or 37%

# To interpret these results we could say that with 95% confidence the percentage of the times
# we should expect to find a student with a mean score of 5 or above to m1 is somewhere
# between 30% and 37%, based on our sample.
#####################################################################
```

# Abstract
*This should be a very brief explanation of your research paper (around 150 words). It normally includes information about the issue, why you are interested in that issue, your method/model, analysis results, discussions and conclusions.*

This paper analyses the data gathered from surveying 625 undergraduate students. The authors of the survey tried to prove two hypothesis: 1) During students' junior years, they tend to primarily focus on getting good grades while during their senior years, the focus shifts towards a deep-understanding of the subject and 2) students' enjoyment and interest tends to deteriorate as they progress through their studies. It is not obvious why this might be the case and if the student's sex or studied subject has any bearing. This is why the survey has 15 questions and probes 7 assessment categories. Each category consists of 3 to 1 questions and because the order of the questions is randomised, the student should not know the categories nor notice any patterns.

The data manipulation was done using R and tidywerse packages. A full analysis will be presented, including data: preparation, analysis, exploration and interpretation; calculation of confidence intervals, interpretation of the results using different kinds of graphs and an explanation of the methods used.

# Introduction
*This section should explain the topic, why it is important, and how you approach the issue*

It is interesting how undergraduate students' goals change through-out their studies. They often experince various syndroms like: burnout, impostour, disheartening or even attempt a suicide. A Harvard graduate, Alex Chang, in his TEDx talk titled ["The Unspoken Reality Behind the Harvard Gates"](https://www.youtube.com/watch?v=WzP7oDCciGI) speaks about the pressure of gettings the best grades; how he was called for a jasmine tea to his tutor and asked if he couldn't give it his all, while he already was doing the best he could. He also recalls one tragic night when he and his roommates were woke up at 4am, to be informed that one of his friend has taken his own life.

Becasue this paper is going to be talking about student's course enjoyment, expectations and his or her focus on grades vs. understanding I would liketo give it another, less visible shade for there might be a lot more to say about a student who is at the bottom of the scale. A student who is not enjoying the course, finds it not interesting but still primarly aims to perform better than others and is lead by the fear of performing poorly. We will try to find such students and calculate the confidence interval of finding a student-at-risk in a given sample, and test the stated hypothesis.


# Data
*Explain your dataset and how the was data is collected – e.g. your sampling strategy or information given by the project information.* 

## Initial Data
This is how the data looked like before we started cleaning it:

```{r}
StudentGoalsOriginal[6:9,1:17]
StudentGoalsOriginal[6:9,18:20]
```

## Cleaning the Data

First, the *seq* column was dropped since it does not serve any purpose. Second, rows with empty cells were dropped because they could falsify our results.

The following coding information was given to us: 

Sex 1=Male; 2=Female

Subject 1=Management 2=Law
3=Tourism
4=General Economics 5=Accounting 6=Statistics


Around 625 students were surveyed. To conceal the existence of the 7 categories from students, they were presented with the questions in random order. 

The students answered on a 7-level scale; 1 meaning the student feels the statement asked in the quesion is 'Not true of him/her' and 7 meaning the student feels it is 'Very true of him/her'. See the table below for a graphical explanation:

 | | | | | | | |
- | - | - | - | - | - | - | - | -
Not true of me | 1 | 2 | 3 | 4 | 5 | 6 | 7 | Very true of me

The students were presented with the questions in a randomized order. Becasue the random order was known, it was assumed that the collected data was put into a table in the 
The random order was known and the questions were derandomised in the data set, i.e., *question 6* from the *Performance avoidance* category is numbered *1* in the survey. In the data set results for *question 1* were renamed to results for *question 6*. *question 12* from the *Mastery avoidance* category is numbered *2* in the survey, etc. *Table 1* presents this mapping.

| |
- | - |- | - |- | - |- | - |- | - |- | - | - | - | - | - |
Survey order | 6 | 12 | 11 | 1 | 7 | 2 | 10 | 8 | 5 | 3 | 9 | 4 | 13 | 14 | 15
Category mapping | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15
Table: In the survey, questions from 1 to 12 were ordered randomly; questions 13, 14 and 15 remained in the same order.

*Table 1* presents the category, its interpretation (Based on the category's questions) and the questions' numbers.

Category | Interpretation | Question | # of Questions
------------ | ------------- | ------------ | ------------
Performance approach | Importance of doing better than others? | 1, 2, 3 | 3
Performance avoidance | Motivation based on the fear of performing poorly | 4, 5, 6 | 3
Mastery approach | Prevalence of mastery approach | 7, 8, 9 | 3
Mastery avoidance | Student's fear of not mastering the course | 10, 11, 12 | 3
Interest | Student expects the course to be interesting | 13 | 1
Enjoyment | Student expects the course to be enjoyable | 14 | 1
Importance focus | Student's importance focus on understanding vs. grades | 15 | 1
Table: Table 1

Because `Interest`, `Enjoyment` and `Importance focus` categories consisted only of 1 question, no further computation was required to interpret the data from these categories.
For the remaining categories, which number of questions was equal to 3, a mean for each assessment category was computed, and saved for each individual student.
This resulted in 4 extra columns added to the original data set. An example of these can be seen below:

```{r}
dat_tibble[1:5, 20:23]
```


# Methodology
*This section explains the statistical methods and/or your model. It is also a common practice to present the statistical model structure (i.e. equation) here as well.*

Confidence interval was used.

tidyverse packages (ggplot2, dplyr, tibble, readr, tidyr, purrr);


# Results
*Present both your informal and formal analyses.*

analyse the m1, m2, m3, m4 graphs bro

```{r}
mm2[,c("age", "sex", "subject", "enjoy", "interest", "mastgrad", "m1", "m2")]
```

Upper end of interval is `r upper_end_of_interval[1,]` which means we could say that with 95% confidence the percentage of the times we should expect to find a student at risk is 0.7%.

# Conclusion / Discussion
*You need to conclude your project, discuss the results, discuss any reservations that you have about the study and list any future work.*

The hypothese turned out to be true/false?

This might not seems like a lot but we have the actual data to back it up. We know that there are 2 students who might be at risk of developing mental health problems: they are both female, aged 18 years old and study general economics at their sophmore year. Wheter this data should be used directly to try to find these students is a different debate. What could be definietly done is try to announce this fact that there have been found students who might be at risk and that there is help available. Most universities offer counceling for students but the problem is to have already troubled and lonely students reach out for help. Maybe a university could develop their own programmes for sutdents which they can use to self-diagnose and if the system would detect that they might be experiencing mental health problems they could direct them towards a councelor at their univeristy. Such tests already exists but the reason why I think they should be university specific is for the fact that it makes the student feels that their university cares about their mental health and they do not need to feel ashamed to ask for help becasue it was their home institution who has made the first step. 

**Univerity should be the one reaching out, not the other way around.**

so, what conclusions do you have bruh? Could analyse AGE


```{r}
# 1) During students’ junior years, they tend to primarily focus on getting good grades while during their senior years, the focus shifts towards a deep-understanding of the subject and. 

# Plot set on basis of the student's sex.
# Plot mean results of performance approach questions
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(mean_dat$year, mean_dat$m1))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = loess, formula = y ~ x, se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's grade-orientation focus set on basis of:
different years of study, sexes and subjects.",
  subtitle = "How important it is to students to do better than others?",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Answer: 1 (Low) - 7 (High)",
  colour = "Sex",
  shape = "Subject"
)

# Plot set on basis of the student's subject.
# Plot mean results of performance approach questions
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(mean_dat$year, mean_dat$m1))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = loess, formula = y ~ x, se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's grade-orientation focus set on basis of:
different years of study, sexes and subjects.",
  subtitle = "How important it is to students to do better than others?",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Answer: 1 (Low) - 7 (High)",
  colour = "Sex",
  shape = "Subject"
)
```


```{r}
# 2) students’ enjoyment and interesttends to deteriorate as they progress through their studies. 
# It is not obvious why this mightbe the case and if the student’s sex or studied subject has any bearing

# Plot set on basis of the student's sex.
# Plot mean results of performance approach questions
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(mean_dat$year, mean_dat$m1))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = loess, formula = y ~ x, se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's grade-orientation focus set on basis of:
different years of study, sexes and subjects.",
  subtitle = "How important it is to students to do better than others?",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Answer: 1 (Low) - 7 (High)",
  colour = "Sex",
  shape = "Subject"
)

# Plot set on basis of the student's subject.
# Plot mean results of performance approach questions
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(mean_dat$year, mean_dat$m1))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = loess, formula = y ~ x, se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's grade-orientation focus set on basis of:
different years of study, sexes and subjects.",
  subtitle = "How important it is to students to do better than others?",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Answer: 1 (Low) - 7 (High)",
  colour = "Sex",
  shape = "Subject"
)
```


```{r}
# interest
# Plot mean results of course interestedness expectations questions
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(year, mean_dat$interest))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = stats::loess, formula = y ~ log(x), se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's course interestedness expectations set on basis of:
different years of study, sexes and subjects.",
  subtitle = "\'I expect my courses this semester to be very interesting\'",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Expectations: 1 (Low) - 7 (High)",
  colour = "Sex",
  shape = "Subject"
)
```


```{r}
# enjoy
# Plot mean results of course enjoyment expectations questions 
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(year, mean_dat$enjoy))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = stats::loess, formula = y ~ log(x), se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's course enjoyment expectations set on basis of:
different years of study, sexes and subjects.",
  subtitle = "\'I expect my courses this semester to be very enjoyable\'",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Expectations: 1 (Low) - 7 (High)",
  colour = "Sex",
  shape = "Subject"
)
```


```{r}
# mastgrad
# Plot mean results of (Primarly understanding/Equal Importance/Primarly grades)scale 
# for all students with relation to student's year, sex and subject
# data
d <- ggplot(data = dat, aes(year, mean_dat$mastgrad))
# mapping data (use "jitter" to improve the graph and avoid gridding)
l <- d + geom_jitter(aes(colour = sex, shape = subject))
# smoothing
s <- l + geom_smooth(method = stats::loess, formula = y ~ log(x), se = TRUE)
# adding theme
t <- s + theme_dark()
# adding colouring
c <- t + scale_colour_brewer(palette = "Pastel1")
# adding labels
c + labs(
  title = "Student's importance scale between understanding and grades set on basis of:
different years of study, sexes and subjects.",
  subtitle = "Scale: Primarly understanding (1) / Equal Importance (4) / Primarly grades (7)",
  caption = "Data source: Elliot, A. J. and McGregor, H. A. (2001)",
  x = "Year (1-4)",
  y = "Scale: 1 (Understanding) - 4 (Equal) - 7 (Grades)",
  colour = "Sex",
  shape = "Subject"
)
```